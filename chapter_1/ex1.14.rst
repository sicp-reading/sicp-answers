Exercise 1.14
=====================

解答: count-change 手続きが 11 セントの両替の場合に生成するプロセスを示す木構造
------------------------------------------------------------------------------------

a セントを b 種類の硬化を使って両替の場合の数を計算する時, (a b) の木構造を以下のように示す.

.. code-block:: sh

       (11 5) - (-39 5)
          |
       (11 4) - (-14 4)
          |
       (11 3) - (1 3) - (-9 3)
          |       |
          |     (1 2) - (-4 2)
          |       |  
          |     (1 1) - (0 1)
          |       |
          |     (1 0)
       (11 2) - (6 2) - (1 2) - (-4 2)
          |       |       |
          |       |     (1 1) - (0 1)
          |       |       |
          |       |     (1 0)
          |     (6 1) - (5 1) - (4 1) - (3 1) - (2 1) - (1 1) - (1 0)
          |       |       |       |       |       |       | 
          |       |       |       |       |       |     (1 0)
          |       |       |       |       |     (2 0)
          |       |       |       |     (3 0)
          |       |       |     (4 0)
          |       |     (5 0)
          |     (6 0)
          |   
       (11 1) - (10 1) - (9 1) - (8 1) - (7 1) - (6 1) - (5 1) - (4 1) - (3 1) - (2 1) - (1 1) - (0 1)
          |        |       |       |       |       |       |       |       |       |       |
          |        |       |       |       |       |       |       |       |       |     (1 0)
          |        |       |       |       |       |       |       |       |     (2 0)
          |        |       |       |       |       |       |       |     (3 0)
          |        |       |       |       |       |       |     (4 0)
          |        |       |       |       |       |     (5 0)
          |        |       |       |       |     (6 0)
          |        |       |       |     (7 0)
          |        |       |     (8 0)
          |        |     (9 0)
          |     (10 0)
       (11 0)

両替の金額の増加によるこのプロセスが使うスペースの増加の程度
------------------------------------------------------------

この手続きにおいて, 両替の金額である amount の数だけ (<amount の数> 1) のノードの数が増加する. 
すなわち amount の数の分だけスペースは肥大するので, amount の数を N とすると, スペースの増加の程度は :math:`\Theta(N)` と考えられる.

両替の金額の増加によるこのプロセスが使うステップ数の増加の程度
------------------------------------------------------------

まず (a, 1) のステップ数を考える. (a, 1) のステップ数を f(a, 1) とおくと

.. math::

   f(a, 1) = f(a, 0) + f(a-1, 1)
          = f(a, 0) + f(a-1, 0) + f(a-2, 1)
          = f(a, 0) + f(a-1, 0) + f(a-2, 1) + ... + f(0, 1)
          = f(a, 0) + \sum_{a}^{k=0} f(a-k, 0) + f(0, 1)
          = \Theta (1)\ + \Theta (a)\ + \Theta (1)\
          = 0 + \Theta (a)\ + 0
          = \Theta (a)\

(a, 1) のステップ数は :math:`\Theta (a)\` となる. ... (1)

次に (a, 2) のステップ数を考える. 

.. math::

   f(a, 2) = f(a, 1) + f(a-5, 2)
           = f(a, 1) + f(a-5, 1) + f(a-10, 2)
           = f(a, 1) + f(a-5, 1) + f(a-10, 1) + ... + f(a-5c, 1) + f(0, 2) \(ここで c = a/5)
           = f(a, 1) + (f(a-5, 1) + f(a-10, 1) + ... + f(a-5c, 1)) + f(0, 2)
           = \Theta (a)\ + (\Theta (a-5)\ + \Theta (a-10)\ + ... + f(a-5c, 1)) + \Theta (1)\
           = \Theta (a)\ + \sum_{a/5}^{k=0} f(\Theta (a-5k)\) + 0
           = \Theta (a)\ + \sum_{a/5}^{k=0} f(\Theta (a)\)
           = \Theta (a)\ + \sum_{a}^{k=0} f(\Theta (a)\)
           = \Theta (a)\ + \Theta (a^2)\
           = \Theta (a^2)\

(a, 2) のステップ数は :math:`\Theta (a^2)\` となる. ...(2)

また, (a, 3) (a, 4) の場合も同様に考えていくと

.. math::

   f(a, 1) = f(a, 0) + f(a-1, 1) = \Theta (a)\
   f(a, 2) = f(a, 1) + f(a-5, 2) = \Theta (a^2)\
   f(a, 3) = f(a, 2) + f(a-10, 3) 
           = \Theta (a^2)\ + \sum_{a/10}^{k=0} f(\Theta ((a-10k)^2)\)
           = \Theta (a^2)\ + \sum_{a}^{k=0} f(\Theta (a^2)\)
           = \Theta (a^2)\ + \Theta (a^3)\
           = \Theta (a^3)\   ...(3)        
   f(a, 4) = f(a, 3) + f(a-25, 4)
           = \Theta (a^3)\ + \sum_{a/25}^{k=0} f(\Theta ((a-25k)^3)\)
           = \Theta (a^3)\ + \sum_{a}^{k=0} f(\Theta (a^3)\)
           = \Theta (a^3)\ + \Theta (a^4)\
           = \Theta (a^4)\   ...(4)

(1) ~ (4) から (a, b) のステップ数は :math:`\Theta (a^b)\` ...(5)
と仮定し, これが任意の自然数 b において成立することを証明する.

**b = 1 の場合**

| (1) から (a, 1) のステップ数は :math:`\Theta (a)\` となることが示された.

次に, 任意の自然数 k において b = k の場合, (5) の命題が成り立つ,
すなわち (a, k) のステップ数は :math:`\Theta (a^k)\` が成り立つと仮定する.

**b = k+1 の場合**

硬化の種類の金額を値の小さいものなら並べた数列 C を :math:`C = (1, 5, 10, 25, 50...) = (c_1, c_2, c_3, c_4, c_5...c_n)` とおき,
b = k+1 の場合の f(a, n+1) を考える.

.. math::
   
   f(a, n+1) = f(a, n) + f(a-c_{n+1}, n+1)
             = \Theta (a^n)\ + \sum_{a/c_{n+1}}^{k=0} f(\Theta ((a-c_{n+1}k)^n)\)
             = \Theta (a^n)\ + \sum_{a}^{k=0} f(\Theta (a^n)\)
             = \Theta (a^n)\ + \Theta (a^{n+1})\
             = \Theta (a^{n+1})\ 

よって, (a, k+1) のステップ数は :math:`\Theta (a^{n+1})\` となり, (a, k) が成り立つことを使うと (a, k+1) の場合も命題が成り立つ.
以上のことから, 帰納法により任意の自然数 b について (a, b) のステップ数は :math:`\Theta (a^b)\` という命題が成り立つ.
